[TOC]

### 1.基本术语

##### 1.结点node

网络中的结点可以是计算机、集线器、交换机或路由器等。

##### 2.链路link

从一个结点到另一个结点的物理线路。

##### 3.主机host

连接在因特网上的计算机

##### 4.ISP

Internet Service Provider，因特网服务提供商。

##### 5.IXP

Internet Exchange Point，互联网交换点，主要作用是允许两个网络直接相连并交换分组，不需要通过第三个网络来转发分组。

##### 6.RFC

Request For Comments，请求评议，包含了关于因特网几乎所有的重要文字资料。

##### 7.WAN

Wide Area Network，广域网，任务是通过长距离运送主机发送的数据。

##### 8.MAN

Metropolitan Area Network，城域网，用来将多个局域网相连。

##### 9.LAN

Local Area Network，局域网，某一区域内由多台计算机互连组成的计算机组。

##### 10.PAN

Personal Area Network，个人区域网，个人的电子设备用无线技术连接起来的网络。

##### 11.packet

分组，又叫包，是因特网中传送的数据单元，由header和数据段组成。

##### 12.存储转发

路由器收到一个分组/包，先检查分组是否正确，并过滤掉冲突包错误。确定包正确后，取出目的地址，通过查找表找到发送的端口地址，并将该包发送出去。

##### 13.带宽

在计算机网络中，表示在单位时间内从网络中某一点到另一点能通过的“最高数据率”，用来表示网络的通信线路所能传送数据的能力，单位是比特/秒，记为b/s。

##### 14.吞吐量

单位时间内通过某个网络的数据量。受带宽或网络的额定速率限制。

### 2.计算机网络性能指标

速率、带宽、吞吐量、时延、时延带宽乘积、往返时间和信道利用率。

### 3.物理层

##### 1.香农定理

在带宽受限且有噪声的信道中，为了不产生误差，信息的数据传输速率有上限值。

##### 2.物理层的作用

透明地传输比特流或者说确定与传输媒体的接口的一些特性：机械特性，电气特性，功能特性，过程特性。尽可能屏蔽掉传输媒体和通信手段的差异，使物理层上面的数据链路层感觉不到这些差异，使物理链路层只需要考虑本层的协议和服务，不需要考虑传输媒体和通信手段。

##### 3.信道复用技术

频分复用：用户在同样的时间占用不同的带宽资源。

时分复用：用户在不同时间占用相同的频带宽度。

统计时分复用：改进的时分复用。

码分复用：用户使用特殊处理过的不同码型，有抗干扰能力。

波分复用：光的频分复用。

##### 4.宽带接入技术

ASDL：非对称数字用户线。

HFC：光纤同轴混合网。

FTTx：光纤到x。

### 4.数据链路层

三个基本问题：封装成帧、透明传输、差错检测。

信道：点对点信道，广播信道。

##### 1.数据链路

把实现控制数据传输的协议的硬件和软件加到链路上就构成了数据链路。

##### 2.PPP

点对点协议，用户计算机和ISP进行通信是所使用的数据链路层协议。

标志字段、地址字段、控制字段、协议字段、信息字段、帧检验序列FCS等。

##### 3.MAC

Media Access Control，媒体访问控制或称物理地址、硬件地址。

##### 4.网桥

用于数据链路中继，连接多个局域网网络的设备。

##### 5.交换机

交换机是在通信系统中完成信息交换的设备。在数据链路层的交换机是交换式集线器，实质是一个多接口的网桥。

### 5.网络层

##### 1.IP

Internet Protocol，网际协议IP是TCP/IP体系中最主要的协议之一。

##### 2.ARP

Address Resolution Protocol，地址解析协议，ARP将IP地址解析成硬件地址。

##### 3.ICMP

Internet Control Message Protocol，网络控制报文协议，用于在IP主机和路由器间传输控制信息，允许主机或路由器报告差错情况和提供有关异常情况的报告。

##### 4.子网掩码

subnet mask，用来表示IP地址哪些位表示主机所在的子网，哪些位标识主机的位掩码。子网掩码不单独存在，与IP地址一起使用。

##### 5.CIDR

无类别域间路由，消除了传统的A类、B类、C类地址和划分子网的概念，改用各种长度的“网络前缀”来代替分类地址的网络号和主机号。

##### 6.静态路由、默认路由

静态路由：由用户或网络管理员手动配置的路由信息。

默认路由：一种特殊的静态路由，当路由表与数据包目的地址没有匹配的标项时，数据包将按默认路由条目进行转发。

##### 7.路由选择算法

路由选择协议的核心部分，因特网采用自适应的，分层次的路由选择协议。

### 6.传输层

##### 1.TCP

传输控制协议

面向连接、每一条TCP只能是一对一的、提供可靠连接、提供全双工通信、面向字节流。

**TCP报文段首部：**

序号字段：使用报文段第一个字节的序号。

确认号字段：期望收到对方下一个报文段的第一个字节的序号。

数据偏移：首部的长度。

紧急位URG：URG=1，表明紧急指针字段有效，优先传送。

确认位ACK：ACK=1时确认字段才有效，建立连接后的报文段ACK都为1。

同步位SYN：建立连接时使用。

终止位FIN：FIN=1表明发送方数据发送完毕，准备关闭连接。

窗口字段：表示可以发送的数据量。

##### 2.UDP

用户数据报协议

无连接、尽最大努力交付、面向报文、无拥塞控制、支持一对一，一对多，多对一，多对多的交互通信、首部开销小。

### 7.应用层



### 8.OSI与TCP/IP各层结构

OSI开放式系统互联，共七层：

物理层、数据链路层、网络层、运输层、会话层、表示层、应用层。

TCP/IP共四层：

网络接口层、网际层IP、运输层、应用层。

五层协议结构：

物理层、数据链路层、网络层、传输层、应用层。

### 9.TCP三次握手四次挥手

##### 1.三次握手

第一次握手：客户端发送SYN=1和随机产生的seq number数据包给服务端。

第二次握手：服务端发送SYN=1/ACK=1、ack number=seq number + 1和随机产生的seq number数据包给客户端。同时为TCP连接分配缓存和变量。

第三次握手：客户端检查ack number是否是seq number+1，发送ACK=1和ack number=seq number+1数据包给服务端。同时为TCP连接分配缓存和变量。

服务端的资源在第二次握手分配，客户端的资源在第三次握手分配。

SYN同步序列编号

##### 2.为什么三次握手（不对）

三次握手的目的是建立可靠的通信信道，确认数据发送方与接收方的通信是正常的。

第一次握手：客户端什么也不确认；服务端确认对方发送正常，自己接收正常。

第二次握手：客户端确认自己发送正常，接收正常，对方发送、接收正常；服务端确认对方发送正常，自己接收正常。

第三次握手：客户端确认自己发送正常，接收正常，对方发送、接收正常；服务端确认自己发送正常，接收正常，对方发送、接收正常。

##### 3.第二次传回了ACK，为何还要传回SYN

传回SYN是服务端为了告诉客户端，接收到的数据是客户端发送的数据。确认客户端到服务端的信道是正常的。

传回ACK是为了确认服务端到客户端的信道是正常的。

##### 4.四次挥手

第一次挥手：客户端发送连接释放报文段，并停止发送数据，主动关闭TCP连接，该报文段FIN=1，seq等于已传送过的数据的最后一个序号+1，用来关闭客户端到服务端的连接。

第二次挥手：服务端收到FIN，发送ACK，确认序号为收到序号+1，此时从客户端到服务端的连接关闭。

第三次挥手：服务端发送连接释放报文段，FIN=1

第四次挥手：客户端收到FIN，发送ACK。

### 10.TCP、UDP区别

TCP：面向连接，传输可靠，传输方式是字节流，传输效率慢，所需资源多，适用于要求传输可靠的场景（邮件传输，文件传输）

UDP：无连接，传输不可靠，传输方式是数据报文段，传输效率高，所需资源少，适用于要求通信速度高的场景（QQ，直播，域名转换）。

### 11.TCP如何保证可靠传输

##### 1.序号

TCP首部的序号字段保证数据能够有序的提交给应用层，TCP把数据视为无结构的有序的字节流，序号在字节流上。TCP传输的数据每个字节都有一个序号，序号字段是一个发送数据第一个字节的序号。假设一个报文数据的序号字段是201，携带100B的数据，则下一个应该接收的数据的序号字段应该是301.

##### 2.确认

确认字段在ACK=1时有效，代表下一个需要接收数据的序号字段。

##### 3.重传

**超时：**TCP每发送一个报文段，就设置一个计时器，如果在计时器时间之后还没有收到这个报文段的确认信息，则进行重传。

保存加权平均往返时间，超时重传时间应该比加权平均往返时间大一点。

**冗余ACK：**假设发送序号1，2，3，4，5的报文段，报文段2丢失后，接收到的3，4，5报文段成为失序报文段，每接收到一个失序报文段，就回传一个冗余ACK，发送方接收到多个同一报文的冗余ACK，则认为此报文段丢失，进行重传。

##### 4.流量控制

匹配发送方发送速率和接收方接收速率。

基于滑动窗口的流量控制机制，使用TCP首部的窗口字段控制可以接收数据的大小，防止接收方缓存溢出。

接收窗口：接收方通过接收缓存的大小，动态调整发送方的发送窗口大小，称为接收窗口。

拥塞窗口：发送方通过估算网络拥塞程度确定窗口值，称为拥塞窗口。

发送方能发送的最大数据为接收窗口和拥塞窗口的最小值。

##### 5.拥塞控制

拥塞控制：防止过多的数据注入网络，保证网络中的路由器或链路不过载。

**拥塞控制和流量控制**

​	相同点：都是控制发送方发送数据的速率。

​	不同点：拥塞控制是让网络能够承受现有的网络负荷，是一个全局性的过程，涉及所有主机路由器链路等等；流量控制只是控制发送方与接收方的流量速率。

​	例如一个链路带宽是10GB/s，以1GB/S的速率向PC发送数据，不存在拥塞问题，但可能存在PC无法接受的问题，此时要流量控制；如果20台机器以1GB/S速率向PC发送数据，则网络过载，需要拥塞控制。

**方法**

慢开始、拥塞避免、快重传、快恢复。

**慢开始：**TCP建立好后，令拥塞窗口为1，每收到一轮报文段的确认后，将拥塞窗口扩大为两倍，一直到拥塞窗口大小大于等于慢开始门限，改用拥塞避免算法。

**拥塞避免：**使拥塞窗口线性增长，当出现超时（网络拥塞）时，令慢开始门限等于当前拥塞窗口的一半，再令窗口为1，改用慢开始算法。

**快重传：**当发送方连续收到3个重复的冗余ACK时，不管计时器是否到时，直接重传一个未接收到的报文。

**快恢复：**当收到3个重复的冗余ACK时，直接将慢开始门限设为当前拥塞窗口的一半。与拥塞避免算法不同的是，将拥塞窗口设为慢开始门限，之后使窗口线性增大。略过了慢开始过程，所以称为快恢复。

当检测到超时时，采用慢开始和拥塞避免；当接收到冗余ACK时，采用快重传和快恢复。

### 12.ARQ协议

ARQ自动重传请求，通过使用确认和超时重传机制，在不可靠服务的基础上实现可靠传输。包括停止等待ARQ协议和连续ARQ协议。

##### 1.停止等待ARQ协议

每发送完一个分组就停止发送，等待对方确认（回传ACK），如果过了一段时间还没有收到确认ACK，则认为没有发送成功，会重新发送，直到收到ACK再发送下一个分组。

收到重复分组，接收方丢弃分组，并回传ACK。

##### 2.连续ARQ协议

可以提高信道利用率。发送方维护一个发送窗口，位于发送窗口内的分组可以连续发送出去，不需要等待对方确认。接收方采用累积确认，对按序到达的最后一个分组发送确认，表示到这个分组之前的所有分组都已经正确接收。

缺点：丢失之后的分组状态不知道，把丢失之后的所有分组重传一次。

### 13.输入url地址到显示网页的过程

1.浏览器查找域名的IP地址，查询顺序（浏览器缓存--路由器缓存--DNS缓存）

2.浏览器向web服务器发送HTTP请求

3.服务器处理请求

4.服务器发送HTML相应

5.浏览器处理HTML文件，渲染网页

**使用的协议：**DNS，TCP，IP，OSPF，ARK，HTTP

DNS解析-TCP连接-发送HTTP请求-处理请求返回HTML-浏览器渲染网页-连接关闭。

### 14.状态码

1XX：信息性状态码，接收的请求正在处理。

2XX：成功状态码，请求正常处理完毕。

3XX：重定向状态码，需要附加操作完成请求。

4XX：客户端错误状态码

5XX：服务器错误状态码

200成功，301资源永久迁移，302临时迁移，404无法找到资源，403服务器拒绝执行请求，500服务器内部错误

### 15.HTTP短连接、长连接

HTTP1.0中使用短连接，客户端和服务端每进行一次HTTP操作，建立一次连接。

HTTP1.1起，默认使用长连接，即建立连接后的一段时间保持TCP连接。

HTTP的长连接实质上是TCP的长连接。

### 16.Session

HTTP是无状态的协议，即不对请求和响应之间的通信状态进行保存，使用Session。Session通过服务器端记录用户的状态。安全性较高。

在cookie中存放一个Session ID，cookie被禁用则使用URL重写把SessionID写在URL后面。

##### session维护用户登录过程：

1.用户登录，登录账号和密码放在请求报文中传送给服务器。

2.服务器验证用户名和密码，如果正确则把y用户信息存在redis中，key就是session ID。

3.服务器返回给客户端的响应报文的set-cookie中包含了session ID，客户端会将cookie存在本地。

4.再次发送请求，会将cookie携带发送，服务器收到报文后会从cookie中提取出session ID，继续业务操作。

### 17.Cookie

Cookie和Session都是用来跟踪浏览器用户信息。

Cookie用来保存用户信息，将token放在cookie中可以保持登录，cookie数据保存在客户端上。

cookie是服务器向客户端发送的一小块数据，通过响应报头的set-cookie传给客户端，浏览器在之后向同一服务器发送请求会携带上cookie。

##### 1.目的

1.会话管理：用户状态，购物车，游戏得分等。

2.个性化：用户偏好，主题等。

3.追踪：记录分析用户的行为。

##### 2.分类

会话型cookie：浏览器关闭后删除，仅在会话器有效。

持久性cookie：可以指定过期时间，指定了过期时间的cookie就是持久性cookie。

### 18.Http1.0和1.1

##### 1.长连接

Http1.0采用短连接方式，即每次请求都要建立一次连接，进行三次握手四次挥手，开销非常大；Http1.1采用长连接方式，在请求完一次后，TCP连接不关闭，可以继续进行请求。持续连接有两种方式：流水线方式（在受到相应报文之前就可以进行下一次请求）、非流水线方式（受到响应报文之后才能发送下一份请求报文）。

##### 2.错误状态码

Http1.1中新增了24个错误状态码，如409：请求的资源与当前资源状态冲突，410：服务器上某个资源被永久删除。

##### 3.流水线

Http1.1支持流水线。流水线就是在同一个连接里，不需要等到上一个请求的响应接收到，就可以发送下一个请求。

##### 4.虚拟主机

Http1.1支持虚拟主机。

### 19.URI、URL、URN

URI统一资源标识符：可以唯一标识一个资源。

URL统一资源定位符：提供资源的路径，不仅可以标识一个资源，还可以定位资源。

URN统一资源名称：也可以唯一标识一个资源，通过名称标识资源。

URL、URN都是URI的子集。

### 20.HTTP和HTTPS

##### 1.端口

HTTP的URL起始地址是“Http://”，默认端口80；HTTPS的URL起始地址是“Https://”，默认端口443。

##### 2.安全型和资源消耗

HTTP建立在TCP之上，所有传输的内容都是明文，双方无法验证对方的身份；HTTPS建立在SSL/TLS之上的HTTP协议，SSL/TLS运行在TCP之上，通过对称加密，但对称加密的密钥用服务器的证书进行非对称加密。HTTPS比HTTP安全，但更耗费资源。

**对称加密：**加密解密使用同一个密钥，加密解密速度快。

**非对称加密：**密钥成对出现，加密解密使用不同的密钥，公钥加密需要私钥解密，私钥解密需要公钥解密。

**SSL：**安全套接层。是web服务器与web服务器之间安全交换信息的协议。握手协议、记录协议、警报协议。

**TLS：**传输层安全协议，是标准化后的SSL。

### 21.HTTP

##### 1.请求报文

客户端给服务器发送请求报文，服务器根据请求报文中的信息进行处理，并将处理结果放入响应报文返回给客户端。

**结构：**

1.第一行：请求方法，URL，协议版本

2.请求首部：

accept：接受的资源格式

accept-charset：编码方式，utf-8

accept-language：优先的语言

user-agent:提供浏览器信息

cookie：cookie信息

host：指向虚拟主机，一个服务器部署了多个网站，通过host确定哪个网站。

referer：记录http请求的来源地址

cache-control：能不能使用缓存

range：如果请求中网络中断，恢复后可以通过range只请求未发送的数据，避免再次重新发送全部数据。请求成功状态码206。

3.空行

4.请求主体

##### 2.响应报文

**结构：**

1.第一行：协议版本、状态码、状态码描述

2.响应首部：

connection：keep-alive

date：时间

charset：编码方式，utf-8

set-cookie：cookie信息

3.空行

4.响应主体：js页面

##### 3.http方法

1.GET：获取资源

参数放在URL地址上，请求主体一般为空。

2.HEAD：获取报文首部

主要用于确认资源有效性。

3.POST：传输数据

数据放在请求主体中，URL一般不带参数。

4.PUT：上传文件

自身不带验证机制，会存在安全问题，一般不用。

5.PATCH：对资源进行部分修改

6.DELETE：删除资源

7.OPTIONS：查询支持的方法

**安全的方法：**GET、HEAD、OPTIONS

**不安全的方法：**POST、PUT、DELETE

##### 4.流水线

默认情况下，http请求按顺序发送，下一个请求只有在上一个请求收到响应之后才发出，这样延迟会很高。

流水线是在同一个长连接上连续发送请求，不需要等待响应返回，减少延迟。

##### 5.幂等性

幂等就是同样的请求被执行多次，效果是一样的，服务器的状态也是一样的。

GET、HEAD、OPTIONS、DELETE是幂等的。

对于DELETE，多次执行的状态码不同，但是幂等的。

### 22.CDN

内容分发网络，可以代替源站响应客户端的请求，依靠边缘服务器，使用户就近获取内容，提高访问速度，降低源站的压力。

### 23.TELNET

远程控制，端口号23，发送数据明文传输，不安全。

SSH是加密的远程控制，加密通信内容，安全。

### 24.STMP

简单邮件传输协议，运行于TCP之上，端口号25
